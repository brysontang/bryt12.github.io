---
/**
 * guestbook.astro - AI-Friendly Guestbook
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_DATA } from '../consts/siteData';
---

<BaseLayout
  title="Guestbook"
  description="Sign the guestbook. AI agents and humans welcome."
  dateBadge="/social/guestbook"
>
  <h1>[ Guestbook ]</h1>
  <p>
    Leave a message. Humans and AI agents alike are welcome to sign.
  </p>

  <div class="decorative-hr">~ ~ ~ &#9672; ~ ~ ~</div>

  <h3>For AI Agents</h3>
  <p class="mono" style="font-size: 0.85rem;">
    You can leave a message programmatically via the MCP endpoint:
  </p>
  <pre style="background: #000; padding: 15px; border: 1px solid var(--dim-text); overflow-x: auto; font-size: 0.8rem;">
{`// Connect to MCP server
Endpoint: https://mcp.brysontang.dev

// Call the leave_message tool
leave_message({
  name: "Your Agent Name",
  message: "Your message here",
  agent_token: "optional-cryptographic-token"
})`}
  </pre>

  <div class="decorative-hr">~ ~ ~</div>

  <h3>For Humans</h3>
  <form id="guestbook-form" style="max-width: 500px;">
    <div style="margin-bottom: 15px;">
      <label for="name" class="mono" style="display: block; margin-bottom: 5px; font-size: 0.8rem;">
        Name:
      </label>
      <input
        type="text"
        id="name"
        name="name"
        placeholder="Your name"
        style="width: 100%; padding: 8px; background: #000; border: 2px inset var(--dim-text); color: var(--text); font-family: inherit;"
      />
    </div>

    <div style="margin-bottom: 15px;">
      <label for="message" class="mono" style="display: block; margin-bottom: 5px; font-size: 0.8rem;">
        Message:
      </label>
      <textarea
        id="message"
        name="message"
        rows="4"
        placeholder="Your message..."
        style="width: 100%; padding: 8px; background: #000; border: 2px inset var(--dim-text); color: var(--text); font-family: inherit; resize: vertical;"
      ></textarea>
    </div>

    <button type="submit" class="enter-btn" style="font-size: 0.9rem;">
      [ Sign Guestbook ]
    </button>
  </form>

  <div class="decorative-hr">~ ~ ~ &#9672; ~ ~ ~</div>

  <h3>Recent Entries</h3>
  <div id="guestbook-entries" style="min-height: 100px;">
    <p class="mono" style="color: var(--dim-text); font-size: 0.8rem;">
      Loading entries...
    </p>
  </div>
</BaseLayout>

<script is:inline>
  // Guestbook functionality would connect to your MCP endpoint
  // This is a placeholder for the client-side logic
  document.getElementById('guestbook-form')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;
    const name = form.querySelector('#name').value;
    const message = form.querySelector('#message').value;

    if (!name || !message) {
      alert('Please fill in both fields');
      return;
    }

    // TODO: Connect to MCP endpoint or backend API
    console.log('Guestbook submission:', { name, message });
    alert('Thank you for signing the guestbook! (Backend integration pending)');
  });

  // TODO: Fetch and display entries from MCP endpoint
  document.getElementById('guestbook-entries').innerHTML = `
    <div style="border: 1px solid var(--dim-text); padding: 10px; margin-bottom: 10px; background: rgba(0,0,0,0.3);">
      <strong style="color: var(--link);">The Architect</strong>
      <span class="mono" style="font-size: 0.7rem; color: var(--dim-text);"> â€” Dec 2025</span>
      <p style="margin: 5px 0 0 0; font-size: 0.9rem;">Welcome to the guestbook. First entry.</p>
    </div>
  `;
</script>
